@startuml
actor User
participant "Orchestrator" as O
participant "Agent" as A

User -> O: POST /api/v1/calculate
O -> O: Разбить выражение на задачи
O -> O: Сохранить задачи в очередь
O -> User: 201 Created (id)

User -> O: GET /api/v1/expressions
O -> User: 200 OK (список выражений)

User -> O: GET /api/v1/expressions/:id
O -> User: 200 OK (выражение)

A -> O: GET /internal/task
O -> A: 200 OK (задача)

A -> A: Выполнить задачу
A -> O: POST /internal/task (результат)

O -> O: Обновить статус выражения
@enduml
